squared_1
y = squared_2(0.1,10);
z = squared_2(0.2,2);
dx = 0.3;
max = 3;
w = squared_2(dx,max);
rand('seed',8776)
A = rmat(5,5)
A =
     4     7     0     8     4
     5     0     9     8     6
     7     1     2     1     6
     2     6     1     6     1
     3     0     4     5     2
b = rvect(5)
b =
     6
     5
     8
     2
     7
rank(A)
ans =
     5
A_aug = [A b]
A_aug =
     4     7     0     8     4     6
     5     0     9     8     6     5
     7     1     2     1     6     8
     2     6     1     6     1     2
     3     0     4     5     2     7
R = rref(A_aug)
R =
    1.0000         0         0         0         0    2.5656
         0    1.0000         0         0         0   -1.4708
         0         0    1.0000         0         0   -1.2692
         0         0         0    1.0000         0    1.3636
         0         0         0         0    1.0000   -1.2190
x_rref = R(1:5,6)
x_rref =
    2.5656
   -1.4708
   -1.2692
    1.3636
   -1.2190
A * x_rref
ans =
    6.0000
    5.0000
    8.0000
    2.0000
    7.0000
b
b =
     6
     5
     8
     2
     7
A_inv = inv(A)
A_inv =
   -0.1544   -0.2451    0.1821    0.1497    0.4231
   -0.1508    0.0862    0.0615    0.3323   -0.3077
   -0.2692    0.1538    0.0385    0.3077   -0.1923
    0.2036   -0.0687   -0.1205   -0.2174    0.2692
    0.2610    0.2318   -0.0487   -0.2964   -0.4231
A * A_inv
ans =
    1.0000    0.0000    0.0000    0.0000   -0.0000
   -0.0000    1.0000   -0.0000   -0.0000    0.0000
         0         0    1.0000    0.0000         0
   -0.0000    0.0000    0.0000    1.0000   -0.0000
   -0.0000   -0.0000    0.0000    0.0000    1.0000
A_inv * b
ans =
    2.5656
   -1.4708
   -1.2692
    1.3636
   -1.2190
x_rref =
    2.5656
   -1.4708
   -1.2692
    1.3636
   -1.2190
x_inv = A_inv * b
x_inv =
    2.5656
   -1.4708
   -1.2692
    1.3636
   -1.2190
A
A =
     4     7     0     8     4
     5     0     9     8     6
     7     1     2     1     6
     2     6     1     6     1
     3     0     4     5     2
rank(A)
ans =
     5
A1 = A(1:5,1:4)
A1 =
     4     7     0     8
     5     0     9     8
     7     1     2     1
     2     6     1     6
     3     0     4     5
A1(1,5) = -19
A1 =
     4     7     0     8   -19
     5     0     9     8     0
     7     1     2     1     0
     2     6     1     6     0
     3     0     4     5     0
A1(2,5) = -22
A1 =
     4     7     0     8   -19
     5     0     9     8   -22
     7     1     2     1     0
     2     6     1     6     0
     3     0     4     5     0
A1(3,5) = -11
A1 =
     4     7     0     8   -19
     5     0     9     8   -22
     7     1     2     1   -11
     2     6     1     6     0
     3     0     4     5     0
A1(4,5) = -15
A1 =
     4     7     0     8   -19
     5     0     9     8   -22
     7     1     2     1   -11
     2     6     1     6   -15
     3     0     4     5     0
A1(5,5) = -12
A1 =
     4     7     0     8   -19
     5     0     9     8   -22
     7     1     2     1   -11
     2     6     1     6   -15
     3     0     4     5   -12
rank(A1)
ans =
     4
A_aug1 = [A1 b]
A_aug1 =
     4     7     0     8   -19     6
     5     0     9     8   -22     5
     7     1     2     1   -11     8
     2     6     1     6   -15     2
     3     0     4     5   -12     7
R1 = rref(A_aug1)
R1 =
     1     0     0     0    -1     0
     0     1     0     0    -1     0
     0     0     1     0    -1     0
     0     0     0     1    -1     0
     0     0     0     0     0     1
x1 = rvect(5)
x1 =
     2
     4
     0
     4
     7
b1 = A1 * x1
b1 =
   -65
  -112
   -55
   -53
   -58
A_aug2 = [A1 b1]
A_aug2 =
     4     7     0     8   -19   -65
     5     0     9     8   -22  -112
     7     1     2     1   -11   -55
     2     6     1     6   -15   -53
     3     0     4     5   -12   -58
R2 = rref(A_aug2)
R2 =
     1     0     0     0    -1    -5
     0     1     0     0    -1    -3
     0     0     1     0    -1    -7
     0     0     0     1    -1    -3
     0     0     0     0     0     0
R2_rref = R2(1:5,6)
R2_rref =
    -5
    -3
    -7
    -3
     0
A1 * R2_rref
ans =
   -65
  -112
   -55
   -53
   -58
b1
b1 =
   -65
  -112
   -55
   -53
   -58
A1 * x1
ans =
   -65
  -112
   -55
   -53
   -58
b1
b1 =
   -65
  -112
   -55
   -53
   -58
clear
A = rmat(3,5)
A =
     8     1     9     0     5
     4     3     2     8     0
     2     2     3     3     5
b = rvect(3)
b =
     3
     5
     1
rank(A)
ans =
     3
A_aug = [A b]
A_aug =
     8     1     9     0     5     3
     4     3     2     8     0     5
     2     2     3     3     5     1
R = rref(A_aug)
R =
    1.0000         0         0    0.9000   -2.0000    1.3000
         0    1.0000         0    2.1600    1.2000    0.5200
         0         0    1.0000   -1.0400    2.2000   -0.8800
x1 = R(1:3,6)
x1 =
    1.3000
    0.5200
   -0.8800
x1(4) = 0
x1 =
    1.3000
    0.5200
   -0.8800
         0
x1(5) = 0
x1 =
    1.3000
    0.5200
   -0.8800
         0
         0 
A * x1
ans =
     3
     5
     1
b
b =
     3
     5
     1
x0 = [R(:,4);-1;0]
x0 =
    0.9000
    2.1600
   -1.0400
   -1.0000
         0
A * x0
ans =
     0
     0
     0
x1 + x0
ans =
    2.2000
    2.6800
   -1.9200
   -1.0000
         0
A * ans
ans =

    3.0000
    5.0000
    1.0000
x2 = x1 + x0
x2 =
    2.2000
    2.6800
   -1.9200
   -1.0000
         0
A * x2
ans =
    3.0000
    5.0000
    1.0000
b
b =
     3
     5
     1
ex1 = x1 + 2 * x0 
ex1 =
    3.1000
    4.8400
   -2.9600
   -2.0000
         0
A * ex1
ans =
     3
     5
     1
b
b =
     3
     5
     1
ex2 = x1 + 3 * x0
ex2 =
     4
     7
    -4
    -3
     0
A * ex2
ans =
     3
     5
     1
b
b =
     3
     5
     1
ex3 = x1 + 69 * x0
ex3 =
   63.4000
  149.5600
  -72.6400
  -69.0000
         0
A * ex3
ans =
    3.0000
    5.0000
    1.0000
b
b =
     3
     5
     1
clear
A = rmat(5,3)
A =
     9     9     1
     8     7     6
     0     3     4
     7     0     3
     6     3     5
rank(A)
ans =
     3
b = [19;21;7;10;14]
b =
    19
    21
     7
    10
    14
A_aug = [A b]
A_aug =
     9     9     1    19
     8     7     6    21
     0     3     4     7
     7     0     3    10
     6     3     5    14
R = rref(A_aug)
R =
     1     0     0     1
     0     1     0     1
     0     0     1     1
     0     0     0     0
     0     0     0     0
x = R(:,4)
x =
     1
     1
     1
     0
     0
A\b
ans =
    1.0000
    1.0000
    1.0000
x = R(1:3,4)
x =
     1
     1
     1
A*x
ans =
    19
    21
     7
    10
    14
diary off